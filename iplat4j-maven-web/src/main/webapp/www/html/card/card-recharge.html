<!doctype html>
<html class="no-js">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<meta name="renderer" content="webkit">
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<meta name="format-detection" content="telephone=no">
		<link rel="stylesheet" href="../reference/mui/css/mui.min.css">
		<link rel="stylesheet" href="../reference/css/common.css" />
		<link rel="stylesheet" href="css/iconfont.css">
		<link rel="stylesheet" href="css/loading.css">
		<link rel="stylesheet" href="css/custom-recharge.css">
		<link rel="stylesheet" href="css/newIcon.css">

	</head>
	<STYLE TYPE="text/css">
		body {
			background: #F3F3F3;
		}
		
		.mui-bar-tab .mui-tab-item.mui-active {
			color: #209c60;
		}
		
		.card-info-div {
			width: 100%;
			padding: 10px 15px;
			border-radius: 3px;
			background: #fff;
			border-bottom: 1px solid #eee;
		}
		
		.card-title {
			width: 100%;
			height: 24px;
			line-height: 24px;
			margin: 10px 0;
			padding-left: 10px;
			border-left: 3px solid #209c60;
			font-weight: bold;
			color: #209c60;
		}
		
		.user-info {
			font-size: 16px;
			font-weight: bold;
			height: 40px;
			line-height: 40px;
		}
		
		.user-info span.iconfont {
			font-size: 30px;
			color: #969696;
		}
		
		.card-no {
			height: 40px;
			line-height: 40px;
			font-size: 16px;
			font-weight: bold;
		}
		
		.card-no span.iconfont {
			font-size: 30px;
			color: #969696;
		}
		
		.balance-info,
		.charge-info {
			height: 40px;
			line-height: 40px;
			color: #6f6f6f;
		}
		
		.money-span {
			font-size: 12px;
		}
		
		.money {
			font-size: 16px;
			font-weight: bold;
		}
		
		.red-money {
			color: #f44336;
		}
		
		.green-money {
			color: #4caf50;
		}
		
		.charge-info-div {
			width: 100%;
			padding: 10px 15px;
			border-radius: 3px;
			background: #fff;
		}
		
		.charge-money-div {
			padding: 5px;
		}
		
		.charge-money {
			height: 60px;
			line-height: 60px;
			text-align: center;
			border-radius: 3px;
			font-size: 18px;
			font-weight: bold;
			color: #209c60;
			border: 1px solid #209c60;
		}
		
		.btn-div {
			width: 100%;
			padding: 5px 5px;
		}
		
		.btn-charge {
			margin-left: 2%;
			width: 96%;
			height: 45px;
			background: #209c60;
			color: #fff;
			border: 1px solid #209c60;
			box-shadow: 1px 3px 15px #209c60;
		}
		
		.charge-money-active {
			background: #209c60;
			color: #fff;
		}
		
		.input-div {
			width: 100%;
			padding: 10px 5px;
		}
		
		input[type=number] {
			width: 100%;
			height: 40px;
			margin-bottom: 0px;
			border: none;
			outline: none;
			padding: 10px 15px 10px 30px;
			font-size: 20px;
			font-weight: bold;
			color: #209c60;
			border-bottom: 1px solid #eee;
		}
		
		.money-icon {
			position: absolute;
			left: 15px;
			top: 21px;
			font-size: 16px;
			color: #209c60;
		}
		
		#userName {
			text-align: center;
			color: #333;
			font-weight: bold;
			font-size: 16px;
			margin-bottom: 0;
		}
		
		#userWork {
			text-align: center;
			color: #333;
			font-weight: bold;
		}
		
		.content-middle {
			display: flex;
			justify-content: center;
			margin: 25px 15px;
			border-bottom: 1px solid #DCDCDC;
			margin-bottom: 0px;
		}
		
		.middle-left,
		.middle-right {
			text-align: center;
			width: 100%;
			margin-bottom: 15px;
		}
		
		.middle-p {
			color: #333;
			font-weight: bold;
			font-size: 15px;
		}
		
		.content-footer {
			text-align: center;
			margin: 25px 0px;
			/* border-bottom: 1px solid #DCDCDC; */
			margin-top: 140px;
			padding: 15px 0px 0px 0px;
			margin-top: 125px;
			background: #fff;
		}
		
		#Kye {
			color: #ff794a;
			font-size: 30px;
			height: 45px;
			line-height: 45px;
			margin-bottom: 0px;
		}
		
		.dssb {
			display: flex;
			justify-content: space-around;
			margin-bottom: 15px;
			border-top: 1px solid #F5F5F5;
			margin-top: 20px;
			padding: 20px 0px 4px 0px;
		}
		
		.mui-bar-tab {
			top: 44px;
			height: 110px;
		}
		
		.mui-bar-tab .mui-tab-item {
			color: #fff;
		}
		
		.mui-bar .mui-icon {
			font-size: 30px;
		}
		
		.mui-bar-tab .mui-tab-item .mui-icon {
			height: 43px;
			width: 34px;
		}
		
		.mui-bar-tab .mui-tab-item .mui-icon~.mui-tab-label {
			font-size: 15px;
		}
		
		.moneySelfP1 {
			margin-bottom: 5px;
			color: #333;
		}
		
		.moneySelfP2 {
			color: #ff756b;
			/*font-weight: bold;*/
			font-size: 17px;
		}
		
		.moneySelf {
			border-right: 1px solid #F5f5f5;
		}

		.mui-bar {
			background: #209c60;
			box-shadow: none;
		}
	</STYLE>

	<body>
		<header class="mui-bar mui-bar-nav">
			<h1 class="mui-title">账户信息</h1>
			<button id="back" class="mui-btn mui-btn-link mui-btn-nav mui-pull-left">
	        <span class="mui-icon mui-icon-left-nav"></span>
	        首页
	    </button>
		</header>

		<div id="warn" class="warn" hidden>
			<small></small>
		</div>
		<div id="loading" class="loading-div" style="z-index: 999;" hidden>
			<div class="loading-center">
				<div class="loading-center-absolute">
					<div class="object" id="object_one"></div>
					<div class="object" id="object_two"></div>
					<div class="object" id="object_three"></div>
					<div class="object" id="object_four"></div>
				</div>
			</div>
		</div>

		<div class="mui-content">
			<div class="content-top" style="display: none;">
				<img src="img/card.png" style="height: auto;width: 16%;margin-left: 42%;margin-top: 20px;" />
				<p id="userName">名字</p>
				<p id="userWork">工号</p>
			</div>
			<div class="content-middle" style="display: none;">

				<div class="middle-left">
					<p>电话</p>
					<p id="tel" class="middle-p"></p>
				</div>
				<div class="middle-right">
					<p>科室</p>
					<p id="deptName" class="middle-p"></p>
				</div>
			</div>
			<div class="content-footer">
				<p id="Kye" style="">0.00</p>
				<p style="color:#666;font-size:16px;font-weight:bolder;">余额</p>
				<div class="dssb">
					<!--<div class="moneySelf">
						<p class="moneySelfP1"> 福员外</p>
						<p class="moneySelfP2"> 222.00</p>
					</div>
					<div class="moneySelf">
						<p class="moneySelfP1"> 福员外</p>
						<p class="moneySelfP2"> 222.00</p>
					</div>-->
				</div>
			</div>
			<div class="btn-div" >
				<button onclick="location.href='card-recharge-in.html'" type="button" class="btn-charge">去充值</button>
			</div>

		</div>

		<nav class="mui-bar mui-bar-tab" style="background:#209c60;">
			<!--<a id="charge" class="mui-tab-item" href="javascript:void(0)">
				<span class="mui-icon iconfont icon-yue1"></span>
				<span class="mui-tab-label">充值</span>
			</a>-->

			<a id="customHistory" class="mui-tab-item" href="javascript:void(0)">
				<span class="mui-icon iconfont icon-history"></span>
				<span class="mui-tab-label">消费记录</span>
			</a>

			<a id="rechargeHistory" class="mui-tab-item " href="javascript:void(0)">
				<span class="mui-icon iconfont icon-3"></span>
				<span class="mui-tab-label">充值记录</span>
			</a>
		</nav>
	</body>
	<script src="../reference/mui/js/mui.min.js" type="text/javascript"></script>
	<script src="../reference/js/jquery-2.1.4.js" type="text/javascript"></script>
	<script src="../reference/js/common.js" type="text/javascript"></script>
	<!-- <script src="../../cordova.js" type="text/javascript"></script> -->
	<script type="text/javascript">
		var baseUrl = localStorage.getItem("url");
		var workNo = localStorage.getItem("workNo");
		var userName = localStorage.getItem("name");
		if(localStorage.getItem("name") != null)
			$("#userName").text(localStorage.getItem("name"))
		if(localStorage.getItem("workNo") != null)
			$("#userWork").text("工号：" + localStorage.getItem("workNo"))
		if(localStorage.getItem("deptName") != null)
			$("#deptName").text(localStorage.getItem("deptName"))
		if(localStorage.getItem("telPhone") != null)
			$("#tel").text(localStorage.getItem("telPhone"))
		
		//init();
		showMoney();

		function init() {
			$.ajax({
				//url: baseUrl + 'app_basicInfoController.do?queryCardWorkInfo',
				url: baseUrl + 'cardmeal',
                type: 'post',
                headers:{
                    className : 'CardWorkConsumeService',
                    methodName : 'queryWorkInfo'
                },
				data: {
					JSNHID: "UEzTab3BHgDYrE+W7sFECMtYMbF4FNsXM/Wo6WkDWNs="
				},
				success: function(data) {
					//var data = eval("(" + data + ")");
					console.log(data);
					if(data.success ) {
						if(!data.obj || !data.obj[0].cardBalance ){
							return;
						}
						$("#Kye").text(Number(data.obj[0].cardBalance/100).toFixed(2));
						//loadViews();
					} else {
						$("#warn small").html(data.respMsg);
						$("#warn").fadeIn(500);
						setTimeout('$("#warn").fadeOut(500)', 3000);
					}
				}
			});
		}

		function showMoney() {
			$.ajax({
				//url: baseUrl + 'app_basicInfoController.do?queryCardWorkInfo',
				url: baseUrl + 'cardmeal',
                type: 'post',
                headers:{
                    className : 'CardWorkConsumeService',
                    methodName : 'queryCardWorkInfo'
                },
				data: {
					workNo: workNo,
					dataGroupCode: localStorage.getItem("dataGroupCode")
				},
				success: function(data) {
					//var data = eval("(" + data + ")");
					console.log(data);
					if(data.success ) {
						if(!data.obj || !data.obj[0].cardBalance ){
							return;
						}
						$("#Kye").text(Number(data.obj[0].cardBalance/100).toFixed(2));
						//loadViews();
					} else {
						$("#warn small").html(data.respMsg);
						$("#warn").fadeIn(500);
						setTimeout('$("#warn").fadeOut(500)', 3000);
					}
				}
			});
		}

		function loadViews() {
			$.ajax({
				url: baseUrl + 'app_basicInfoController.do?queryMoneyRecordsByUserCode',
				type: 'post',
				data: {
					workNo: workNo
				},
				success: function(data) {
					$("#loading").hide();
					var data = eval("(" + data + ")");
					console.log(data);
					var taskListAppend = "";
					if(data.success) {
						var list = data.obj;
						var mlgb = [];
						for(var i = 0; i < list.length; i++) {
							for(var name in list[i]) {
								mlgb.push(list[i][name])

								taskListAppend += createView1(name, list[i][name]);
							}
						}
						var setWidth = ((1 / mlgb.length * 10000) / 100) + '%';
						$(".dssb").html(taskListAppend);
						$(".moneySelf").width(setWidth);

					} else {
						//						showMsg(data.respMsg);
					}
				}
			});

		}

		function createView1(name, money) {
			var html = "";
			//			html += '<div class="moneySelf">' + name + '&nbsp;&nbsp;';
			//			html += '<span class="money-span red-money">¥ </span>';
			//			html += '<span  class="money red-money">' + money + '</span></div>';
			html += '<div class="moneySelf">';
			html += '<p class="moneySelfP1"> ' + name + '</p>';
			html += '<p class="moneySelfP2">' + Number(money).toFixed(2) + '</p>';
			html += '</div>';
			return html;
		}
		document.addEventListener("deviceready", onDeviceReady, false);

		function onDeviceReady() {
			document.addEventListener("backbutton", onBackKeyDown, false);
		}

		function onBackKeyDown() {
			location.href = "../../menu.html";
		}

		document.getElementById('back').addEventListener('tap', function() {
			location.href = "../../menu.html";
		});

//		document.getElementById('charge').addEventListener('tap', function() {
//			location.href = "card-recharge.html";
//		});
		document.getElementById('customHistory').addEventListener('tap', function() {
			location.href = 'custom-history.html';
		});

		document.getElementById('rechargeHistory').addEventListener('tap', function() {
			location.href = 'recharge-history.html';
		});
	</script>

</html>