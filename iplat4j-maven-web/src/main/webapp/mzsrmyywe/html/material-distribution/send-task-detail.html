<!DOCTYPE html>
<html class="no-js">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="renderer" content="webkit" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="format-detection" content="telephone=no" />
    <link rel="stylesheet" href="../reference/mui/css/mui.min.css" />
    <link rel="stylesheet" href="../reference/css/common.css" />
    <link rel="stylesheet" href="../reference/mui/css/mui.picker.min.css" />
    <link rel="stylesheet" href="css/tcj-font.css" />
</head>
<style type="text/css">
    body,
    html {
        height: 100%;
        background: #f7f7f7;
    }
    
    .row-content {
        height: 35px;
        line-height: 35px;
        padding: 0 15px;
        /*border-bottom: 1px solid #EEEEEE;*/
        font-size: 14px;
        color: #666666;
        background: #ffffff;
    }
    
    .row-right {
        text-align: right;
        color: #333333;
    }
    
    .new-icon-color {
        color: #aaa;
    }
    
    .new-list-content {
        padding: 15px 0;
        background: #fff;
    }
    
    .apply-content1 {
        text-align: left;
        height: 35px;
        line-height: 47px;
        /*font-weight: lighter;*/
    }
    
    .apply-content2 {
        text-align: left;
        height: 35px;
        /*font-weight: lighter;*/
        font-size: 11px;
    }
    
    .apply-bottom {
        border-bottom: 1px solid #eee;
    }
    
    .apply-bottom:last-child {
        border-bottom: 0;
    }
    
    .bottom-list {
        background: #fff;
        padding: 0 15px;
        margin-top: 10px;
        overflow-y: auto;
    }
    
    .new-row-tcj {
        height: 75px;
        /*line-height: 60px;*/
        display: flex;
        justify-content: space-between;
        font-size: 14px;
        position: fixed;
        width: 100%;
        bottom: 0;
    }
    
    .start-send {
        height: 32px;
        width: 21%;
        background: #fafafa;
        text-align: center;
        line-height: 32px;
        border-radius: 15px;
        margin-top: 14px;
        color: #333333;
        font-size: 12px;
        border: 1px solid #eee;
    }
    
    .finish-send {
        height: 32px;
        width: 21%;
        background: #41bde2;
        text-align: center;
        line-height: 32px;
        border-radius: 15px;
        margin-top: 14px;
        color: #fff;
        font-size: 12px;
        box-shadow: 0 0 7px #2aabd2;
    }
</style>

<body>
    <header class="mui-bar mui-bar-nav">
        <h1 class="mui-title" id="beforeTitle">配送任务明细</h1>
        <button onclick="history.back(-1)" class="mui-btn mui-btn-blue mui-btn-link mui-btn-nav mui-pull-left">
        <span class="mui-icon mui-icon-left-nav"></span>
        返回
      </button>
    </header>

    <div id="warn" class="warn" hidden>
        <small></small>
    </div>

    <div id="loading" class="loading1" hidden>
        <div class="loading2">
            <span class="mui-spinner" style="width: 80px; height: 80px"></span>
        </div>
    </div>

    <div class="mui-content">
        <div class="new-list-content">
            <div class="mui-row row-content">
                <div class="mui-col-sm-12 mui-col-xs-12">
                    <span class="mui-icon iconfont icon-apply-keshi new-icon-color"></span> 配送科室：
                    <span class="send-dept">123</span>
                </div>
            </div>
            <div class="mui-row row-content">
                <div class="mui-col-sm-12 mui-col-xs-12">
                    <span class="mui-icon iconfont icon-jiaohuo-date new-icon-color"></span> 配送日期：
                    <span class="send-time"> </span>
                </div>
            </div>
        </div>

        <div class="bottom-list">
            <!--<div class="mui-row apply-bottom ">
					<div class="mui-col-sm-1 mui-col-xs-1" style="line-height: 70px;">
						1.
					</div>
					<div class="mui-col-sm-6 mui-col-xs-6">
						<div class="apply-content1">
							菲尔普斯防水剂
						</div>
						<div class="apply-content2">
							型号&nbsp;&nbsp;1000w
						</div>
					</div>
					<div class="mui-col-sm-5 mui-col-xs-5">
						<div class="apply-content1" style="text-align: right;">
							23减
						</div>
						<div class="apply-content2">
						</div>
					</div>
				</div>
				<div class="mui-row apply-bottom ">
					<div class="mui-col-sm-1 mui-col-xs-1" style="line-height: 70px;">
						1.
					</div>
					<div class="mui-col-sm-6 mui-col-xs-6">
						<div class="apply-content1">
							菲尔普斯防水剂
						</div>
						<div class="apply-content2">
							型号&nbsp;&nbsp;1000w
						</div>
					</div>
					<div class="mui-col-sm-5 mui-col-xs-5">
						<div class="apply-content1" style="text-align: right;">
							23减
						</div>
						<div class="apply-content2">
						</div>
					</div>
				</div>-->
        </div>
    </div>

    <!--<div class="mui-row row-content new-row-tcj">

			<div class="start-send">开始配送</div>
			<div class="finish-send">完成配送</div>
		</div>-->
</body>
<script src="../reference/mui/js/mui.min.js" type="text/javascript"></script>
<script src="../reference/js/jquery-2.1.4.js" type="text/javascript"></script>
<script src="../reference/js/common.js" type="text/javascript"></script>
<script src="../reference/mui/js/mui.picker.min.js" type="text/javascript"></script>
<!-- <script src="../../cordova.js" type="text/javascript"></script> -->
<script src="js/$ajax.js" type="text/javascript"></script>
<script type="text/javascript">
    var baseUrl = localStorage.getItem("url");
    var workNo = localStorage.getItem("workNo");
    var deptNum = localStorage.getItem("deptCode");
    var url = location.search;
    var jsonBackString = url.substring(1, url.length);
    var jsonBackObj = JSON.parse(decodeURIComponent(jsonBackString));
    console.log(jsonBackObj);

    var id = jsonBackObj.id;
    $(".send-dept").text(jsonBackObj.transportDeptName);
    $(".send-time").text(jsonBackObj.transportTime);
    $(".bottom-list").css("height", $(window).height() - 165 + "px");
    loadView();

    function loadView() {
        var prames = {
            id: id,
        };
        prames = JSON.stringify(prames);
        $ajax("query", "MDPS0102", prames, (res) => {
            console.log(res.blocks.result.rows);
            var list = res.blocks.result.rows;
            var tasklist = "";
            list.map((item, index) => {
                tasklist += creatView(
                    item.matNum,
                    item.matName,
                    item.matSpec,
                    item.deliveryNum,
                    item.unitName,
                    index
                );
            });
            $(".bottom-list").html(tasklist);
        });
    }
    // function loadView() {

    // 	$.ajax({

    // 		url: baseUrl + "app_transportController.do?queryTransportTaskDetail",
    // 		type: "post",
    // 		data: {
    // 			transportBillNo: transportBillNo
    // 		},
    // 		success: function(data) {
    // 			var data = eval("(" + data + ")");
    // 			console.log(data)
    // 			var list = data.obj.data;
    // 			var tasklist = "";
    // 			$(".send-dept").text(data.obj.transportDept);
    // 			$(".send-time").text(data.obj.transportTime);
    // 			for(var i = 0; i < list.length; i++) {

    // 				tasklist += creatView(list[i].matNum, list[i].matName, list[i].matSpec, list[i].applyNum, list[i].unit, i);
    // 			}
    // 			$(".bottom-list").html(tasklist);

    // 		}
    // 	});
    // }

    function creatView(matNum, matName, matSpec, applyNum, unit, i) {
        var html = "";
        html += '<div class="mui-row apply-bottom ">';
        html +=
            '<div class="mui-col-sm-1 mui-col-xs-1" style="line-height: 70px;">' +
            (i + 1) +
            ".</div>";
        html += '<div class="mui-col-sm-6 mui-col-xs-6">';
        html += '<div class="apply-content1">' + matName + "</div>";
        html +=
            '<div class="apply-content2">规格&nbsp;&nbsp;' + matSpec + "</div>";
        html += "</div>";
        html += '<div class="mui-col-sm-5 mui-col-xs-5">';
        html +=
            '<div class="apply-content1" style="text-align: right;">' +
            applyNum +
            unit +
            "</div>";
        html += '<div class="apply-content2">';
        html += "</div>";
        html += "</div>";
        html += "</div>";
        return html;
    }

    //系统返回监听
    document.addEventListener("deviceready", onDeviceReady, false);

    function onDeviceReady() {
        /**
         * 系统返回键监听
         */
        document.addEventListener("backbutton", onBackKeyDown, false);
    }

    /**
     * 系统返回键方法
     * @return {[type]} [description]
     */
    function onBackKeyDown() {
        history.back(-1);
    }
</script>

</html>