(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4afa44a0","chunk-71b7a33b","chunk-66be5b76","chunk-0b365138"],{"100e":function(e,t,n){var a=n("cd9d"),o=n("2286"),i=n("c1c9");e.exports=function(e,t){return i(o(e,t,a),e+"")}},"1bef":function(e,t,n){"use strict";n("399b")},"1d92":function(e,t,n){var a=n("e0ef");e.exports=function(e){return a(2,e)}},2286:function(e,t,n){var s=n("85e3"),l=Math.max;e.exports=function(i,r,c){return r=l(void 0===r?i.length-1:r,0),function(){for(var e=arguments,t=-1,n=l(e.length-r,0),a=Array(n);++t<n;)a[t]=e[r+t];for(var t=-1,o=Array(r+1);++t<r;)o[t]=e[t];return o[r]=c(a),s(i,this,o)}}},2474:function(e,t,n){"use strict";n.r(t),n("e7e5");var a=n("d399"),o=n("1da1"),i=(n("96cf"),n("b0c0"),n("a15b"),n("365c")),r={name:"data-upload-bottom",props:{condition:{type:Object,default:function(){return{}}},file_list:{type:Object||Array}},render:function(){var e=this,t=arguments[0];return t("div",{class:"data-upload-bottom"},[t("global-tap",{class:"data-upload-bottom-button-sumbit",on:{tap:function(){e.data_upload_bottom_sumbit_tap()}}},[t("global-van-button",{attrs:{disabled:this.disabled,type:"primary"}},["申请"])])])},data:function(){return{disabled:!0,projectId:this.$route.query.id,workNo:localStorage.getItem("workNo"),name:localStorage.getItem("name"),deptCode:localStorage.getItem("deptCode"),deptName:localStorage.getItem("deptName")}},computed:{},watch:{file_list:{handler:function(e,t){this.change_button_type()},deep:!0,immediate:!0}},methods:{change_button_type:function(){1<=this.file_list.sign.length&&1<=this.file_list.risk.length&&1<=this.file_list.security.length?this.disabled=!1:this.disabled=!0},data_upload_bottom_sumbit_tap:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.$toast.loading({message:"申请中...",forbidClick:!0}),e.next=3,Object(i.a)({workNo:t.workNo,name:t.name,projectId:t.projectId,applyDeptNum:t.deptCode,applyDeptName:t.deptName,projectType:"01",projectTypeName:t.condition.classify,projectName:t.condition.project_name,principalNum:"",companyName:t.condition.company_name,principalName:t.condition.principal,contactTel:t.condition.phone,beginDate:t.condition.start_time,fileIds:t.condition.file_ids.join(",")});case 3:t.$toast.clear(),t.$router.push("/hazardous-operation"),a.a.success("提交成功");case 6:case"end":return e.stop()}},e)}))()}}},n=(n("b089"),n("2877")),r=Object(n.a)(r,void 0,void 0,!1,null,"a80f19f6",null);t.default=r.exports},"2a4b":function(e,t,n){"use strict";n.r(t);var o=n("ade3"),i=n("5530"),a=n("80b0"),r=n.n(a),c=n("1d92"),s=n.n(c),a=(n("d3b7"),n("ddb0"),n("b0c0"),n("e260"),n("027f")),c=n("2f62");t.default={components:Object(a.a)(n("2dc3").keys()),beforeRouteEnter:function(e,t,n){n(function(e){"user-info"==t.name&&e.other_mutations_animate(Object(i.a)(Object(i.a)({},e.other_state_animate),{},Object(o.a)({},e.$route.name,"right")))})},beforeRouteLeave:function(e,t,n){var a={"police-statistics":null,"police-consumption":null,"report-statistics":null,"police-compare":null,"search-consumption":null,"general-situation":null};this.other_mutations_animate(Object(i.a)(Object(i.a)({},this.other_state_animate),{},Object(o.a)({},e.name,a.hasOwnProperty(e.name)?a[e.name]:"left"))),n()},data:function(){return{m_desc:"局部混入mixin"}},computed:Object(i.a)({},Object(c.b)(["other_state_user_info","other_state_animate","other_state_data_dictionary"])),inject:["provide_set_login_info","provide_clear_login_info","provide_reload_app","provide_set_data_dictionary"],methods:Object(i.a)(Object(i.a)({},Object(c.c)(["other_mutations_hospital_info","other_mutations_animate"])),{},{init_animete:s()(function(){var e=this;this.other_mutations_animate(Object(i.a)(Object(i.a)({},this.other_state_animate),{},{"home-page":"van-fade"})),r()(function(){e.other_mutations_animate(Object(i.a)(Object(i.a)({},e.other_state_animate),{},{"home-page":"right"}))})})}),created:function(){this.init_animete()},mounted:function(){}}},"2dc3":function(e,t,n){var a={"./data-upload-bottom.vue":"2474","./data-upload-center.vue":"e3ce","./data-upload-top.vue":"73b9"};function o(e){e=i(e);return n(e)}function i(e){if(n.o(a,e))return a[e];e=new Error("Cannot find module '"+e+"'");throw e.code="MODULE_NOT_FOUND",e}o.keys=function(){return Object.keys(a)},o.resolve=i,(e.exports=o).id="2dc3"},"2e6c":function(e,t,n){},"399b":function(e,t,n){},"4a68":function(e,t){e.exports=function(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout(function(){e.apply(void 0,n)},t)}},"4b17":function(e,t){e.exports=function(e){return e}},"5f4f":function(e,t,n){"use strict";n("6418")},6418:function(e,t,n){},"73b9":function(e,t,n){"use strict";n.r(t);var a=n("1da1"),o=(n("96cf"),n("365c")),i={name:"data-upload-top",props:{},render:function(){var n=this,e=arguments[0];return e("div",{class:"data-upload-top"},[e("global-van-field",{attrs:{label:"分类",readonly:!0,placeholder:"请选择分类",colon:!0,"label-width":"90px"},on:{tap:function(){return n.project_classify_show()}},model:{value:n.condition.classify,callback:function(e){n.$set(n.condition,"classify",e)}}}),e("global-van-field",{attrs:{border:!0,placeholder:"请填写项目名称",label:"项目名称",colon:!0,clickable:!0,"label-width":"90px"},on:{input:function(e){return n.project_name_field_input(e)}},model:{value:n.condition.project_name,callback:function(e){n.$set(n.condition,"project_name",e)}}}),e("global-van-field",{attrs:{border:!0,placeholder:"请填写公司名称",label:"公司名称",colon:!0,clickable:!0,required:!0,"label-width":"90px"},on:{input:function(e){return n.company_name_field_input(e)}},model:{value:n.condition.company_name,callback:function(e){n.$set(n.condition,"company_name",e)}}}),e("global-van-field",{attrs:{border:!0,placeholder:"请填写项目负责人",label:"项目负责人",colon:!0,clickable:!0,required:!0,"label-width":"90px"},on:{input:function(e){return n.charge_person_field_input(e)}},model:{value:n.condition.principal,callback:function(e){n.$set(n.condition,"principal",e)}}}),e("global-van-field",{attrs:{border:!0,type:this.tel,"error-message":this.error_massage,placeholder:"请填写联系电话",label:"联系电话",colon:!0,clickable:!0,required:!0,"label-width":"90px"},on:{input:function(e){return n.telephone_field_input(e)}},model:{value:n.condition.phone,callback:function(e){n.$set(n.condition,"phone",e)}}}),e("global-van-field",{attrs:{border:!0,readonly:!0,label:"项目开始时间",placeholder:"请选择项目开始时间",colon:!0,clickable:!0,required:!0,"label-width":"90px"},on:{tap:function(){return n.start_date_tap()}},model:{value:n.condition.start_time,callback:function(e){n.$set(n.condition,"start_time",e)}}}),e("global-van-popup",{on:{"click-overlay":function(){return n.data_upload_click_overlay()}},attrs:{value:this.select_date_show}},[e("global-van-datetime-picker",{attrs:{type:"date",value:this.select_date_show,"min-date":this.now_time},on:{cancel:function(e){return n.datetime_picker_cancel(e)},confirm:function(e){return n.datetime_picker_confirm(e)}}})]),e("global-project-classify-select",{attrs:{value:this.select_project_classify_show,title:"请选择分类"},on:{"click-overlay":function(){return n.project_classify_click_overlay()},cancel:function(){return n.project_classify_cancel()},confirm:function(e,t){return n.project_classify_confirm(e,t)}}})])},data:function(){return{error_massage:"",tel:"tel",condition:{classify:"",project_name:"",company_name:"",principal:"",phone:"",start_time:""},start_date:"请选择项目开始时间",now_time:new Date,select_project_classify_show:!1,select_datetime:!1,select_date_show:!1,projectId:this.$route.query.id}},watch:{condition:{handler:function(e,t){this.$emit("condition-change",t),this.error_massage_show()},deep:!0},projectId:{handler:function(e,t){this.information_editing(),console.dir(this.projectId)},deep:!0,immediate:!0}},computed:{select_datetime_computed:function(){return this.select_datetime.Format("yyyy-MM-dd")}},methods:{error_massage_show:function(){11===this.condition.phone.length?this.error_massage="":this.error_massage="电话格式不正确"},project_classify_show:function(){this.select_project_classify_show=!0},project_classify_click_overlay:function(){this.select_project_classify_show=!1},project_classify_cancel:function(){this.select_project_classify_show=!1},project_classify_confirm:function(e,t){this.select_project_classify_show=!1,this.condition.classify=e.text},project_name_field_input:function(e){this.project_name=e},company_name_field_input:function(e){this.company_name=e},charge_person_field_input:function(e){this.charge_person=e},telephone_field_input:function(e){this.telephone=e},start_date_tap:function(){this.select_date_show=!0},datetime_picker_cancel:function(e){this.select_date_show=!1},datetime_picker_confirm:function(e){this.select_date_show=!1,this.select_datetime=e,this.condition.start_time=e.Format("yyyy-MM-dd")},data_upload_click_overlay:function(){this.select_date_show=!1},submit_applications:function(){return Object(a.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()},information_editing:function(){var n=this;return Object(a.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(o.g)({projectId:n.projectId||123321});case 2:t=e.sent,n.condition.classify=t.data.projectTypeName,n.condition.project_name=t.data.projectName,n.condition.company_name=t.data.companyName,n.condition.principal=t.data.principalName,n.condition.phone=t.data.contactTel,n.condition.start_time=t.data.beginDate;case 9:case"end":return e.stop()}},e)}))()}}},n=(n("5f4f"),n("2877")),i=Object(n.a)(i,void 0,void 0,!1,null,"27c8297d",null);t.default=i.exports},"80b0":function(e,t,n){var a=n("4a68"),n=n("100e")(function(e,t){return a(e,1,t)});e.exports=n},"85e3":function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},b089:function(e,t,n){"use strict";n("2e6c")},c1c9:function(e,t){e.exports=function(e){return e}},cd9d:function(e,t){e.exports=function(e){return e}},e0ef:function(e,t,n){var a=n("4b17");e.exports=function(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=a(e),function(){return 0<--e&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}},e3ce:function(e,t,n){"use strict";n.r(t),n("4662");var a=n("28a2"),c=n("1da1"),s=(n("96cf"),n("d81d"),n("b0c0"),n("a434"),n("b64b"),n("365c")),o={name:"data-upload-center",props:{otherStateUserInfo:{type:Object,default:function(){return{}}}},render:function(){var a=this,t=arguments[0];return t("div",{class:"data-upload-center"},[this.upload_list.map(function(n,e){return t("div",{class:"data-upload-center-container"},[t("div",{class:"data-upload-center-sign-image"},[t("global-van-uploader",{attrs:{"file-list":a.file_list[n.key],multiple:!0,"max-count":3,"max-size":8388608},on:{delete:function(e,t){return a.uploader_uploader_delete(n.key,e.file_id)},oversize:function(){return a.uploader_oversize()}},scopedSlots:{default:function(e){return t("span")},previewCover:function(e){return t("div",{class:"data-upload-center-sign-image-item-uploader",on:{click:function(){return a.uploading_image_preview(n.key)}}},[t("img",{attrs:{width:"80",height:"80",src:e.url}})])}}})]),t("global-van-field",{attrs:{center:!0,clearable:!0,required:n.required,label:n.text,placeholder:""},class:"data-upload-center-button-field"},[t("template",{slot:"button"},[t("global-tap",{on:{tap:function(){return a.uploader_photograph_local_tap(n.key,"CAMERA",n.resources)}}},[t("global-van-button",{attrs:{icon:"photograph",type:"primary"}},["相机拍摄"])]),t("global-tap",{class:"complete-button-loader",on:{tap:function(){return a.uploader_photograph_local_tap(n.key,"PHOTOLIBRARY",n.resources)}}},[t("global-van-button",{attrs:{icon:"photo-fail",type:"primary"}},["本地上传"])])])])])})])},data:function(){return{projectId:this.$route.query.id,upload_list:[{text:"签订协议",key:"sign",resources:"01",required:!0},{key:"risk",text:"风险评估",resources:"02",required:!0},{key:"security",text:"安全措施",resources:"03",required:!0},{key:"other",text:"其他",resources:"04",required:!1}],file_list:{sign:[],risk:[],security:[],other:[]},files:{sign:[],risk:[],security:[],other:[]}}},computed:{},watch:{projectId:{handler:function(e,t){console.dir(this.projectId)},deep:!0,immediate:!0}},methods:{uploader_after:function(n,a,o,i){var r=this;return Object(c.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.$toast.loading({message:"上传中...",duration:0,forbidClick:!0}),r.files[a].push(o),e.next=4,Object(s.i)({workNo:r.workNo,name:r.name,relateId:"",statusCode:"01",fileResources:i,base64:o,fileName:"".concat((new Date).getTime(),".png")});case 4:t=e.sent,r.$toast.clear(),t.success?(r.file_list[a].push({url:n,base64:o,file_id:t.data}),r.emit_file_ids()):r.$notify({type:"danger",message:"上传失败"});case 7:case"end":return e.stop()}},e)}))()},uploader_uploader_delete:function(n,a){var o=this;this.file_list[n].map(function(e,t){return e.file_id==a&&o.file_list[n].splice(t,1)}),this.emit_file_ids()},emit_file_ids:function(){var t=this,n=[];Object.keys(this.file_list).map(function(e){return t.file_list[e].map(function(e){return n.push(e.file_id)})}),this.$emit("uploader",n),this.$emit("buttonshow",this.file_list)},uploader_photograph_local_tap:function(a,n,o){var i=this;return Object(c.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={PHOTOLIBRARY:{destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,allowEdit:!1,mediaType:Camera.MediaType.PICTURE},CAMERA:{quality:50,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!1,encodingType:Camera.EncodingType.JPEG,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1}},i.m_native_camera_get_picture(t[n],function(){var t=Object(c.a)(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[function(){return i.$notify({type:"danger",message:"您未拍照或者未选择照片"})},function(){var t=Object(c.a)(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.$utils.getImgToBase64(t);case 2:n=e.sent,i.uploader_after(t,a,n,o);case 4:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()],e.t0=t.success,e.t0)return e.next=5,n[t.data.status](t.data.url);e.next=5;break;case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)}))()},uploading_image_preview:function(e){Object(a.a)(this.file_list[e].map(function(e){return e.url}))},uploader_oversize:function(){this.$notify({type:"danger",message:"图片大小不能超过2M"})}}},n=(n("1bef"),n("2877")),o=Object(n.a)(o,void 0,void 0,!1,null,"73fd1921",null);t.default=o.exports}}]);