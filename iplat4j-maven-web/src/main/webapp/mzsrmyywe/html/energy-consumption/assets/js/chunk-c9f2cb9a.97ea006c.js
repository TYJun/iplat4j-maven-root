(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c9f2cb9a","chunk-1266fdc8"],{"100e":function(e,t,i){var n=i("cd9d"),r=i("2286"),a=i("c1c9");e.exports=function(e,t){return a(r(e,t,n),e+"")}},"1d92":function(e,t,i){var n=i("e0ef");e.exports=function(e){return n(2,e)}},2286:function(e,t,i){var s=i("85e3"),u=Math.max;e.exports=function(a,o,c){return o=u(void 0===o?a.length-1:o,0),function(){for(var e=arguments,t=-1,i=u(e.length-o,0),n=Array(i);++t<i;)n[t]=e[o+t];for(var t=-1,r=Array(o+1);++t<o;)r[t]=e[t];return r[o]=c(n),s(a,this,r)}}},4103:function(e,t,i){},"4a68":function(e,t){e.exports=function(e,t,i){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout(function(){e.apply(void 0,i)},t)}},"4b17":function(e,t){e.exports=function(e){return e}},"80b0":function(e,t,i){var n=i("4a68"),i=i("100e")(function(e,t){return n(e,1,t)});e.exports=i},"85e3":function(e,t){e.exports=function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}},"86ea":function(e,t,i){"use strict";i.r(t);var c=i("1da1"),n=(i("e7e5"),i("d399")),r=i("ade3"),s=(i("96cf"),i("d81d"),i("b0c0"),i("a15b"),i("a434"),i("b64b"),i("365c")),a={name:"newperiodic-review-form",props:{},render:function(){var n=this,t=arguments[0];return t("div",{class:"newperiodic-review-form"},[t("global-van-cell-group",[t("global-van-field",{class:"global-van-field-xz",attrs:{readonly:!0,clickable:!0,name:"picker",value:this.select_site_office.text||"请选择项目",label:"选择项目:",placeholder:this.select_site_office.text||"请选择项目",required:!0},on:{tap:function(){return n.newperiodic_review__select_site()}}}),t("global-project-selection",{attrs:{title:"选择 项目类型",office:this.select_site_office},on:{cancel:function(){return n.newperiodic_review__cancel()},confirmid:function(e){return n.queck_confirm_id(e)},confirm:function(e){return n.queck_confirm(e)},"click-overlay":function(){return n.newperiodic_review_click_overlay()}},model:{value:n.select_site_value,callback:function(e){n.select_site_value=e}}}),t("global-van-field",{class:"global-van-field-miaoshu",attrs:{value:this.requirement_description||null,type:"textarea",label:"描述: ",placeholder:"请输入描述"},on:{input:function(e){n.requirement_description_input(e)}}}),t("div",{class:"newperiodic-review-form-image"},[this.upload_list.map(function(i,e){return t("div",{class:"newperiodic-review-form-container"},[t("div",{class:"newperiodic-review-form-sign-image"},[t("global-van-uploader",{attrs:{"file-list":n.file_list[i.key],multiple:!0,"max-count":3,"max-size":8388608},on:{delete:function(e,t){return n.uploader_uploader_delete(i.key,e.file_id)},oversize:function(){return n.uploader_oversize()}},scopedSlots:{default:function(e){return t("span")},previewCover:function(e){return t("div",{class:"newperiodic-review-form-sign-image-item-uploader",on:{click:function(){return n.uploading_image_preview(i.key)}}},[t("img",{attrs:{width:"80",height:"80",src:e.url}})])}}})]),t("global-van-field",{attrs:{center:!0,clearable:!0,disabled:!0,required:!0,label:i.text,placeholder:""},class:"newperiodic-review-form-button-field"},[t("template",{slot:"button"},[t("global-tap",{on:{tap:function(){return n.uploader_photograph_local_tap(i.key,"CAMERA",i.resources)}}},[t("global-van-button",{attrs:{icon:"photograph",type:"primary"}},["相机拍摄"])]),t("global-tap",{class:"newperiodic-review-form-loader",on:{tap:function(){return n.uploader_photograph_local_tap(i.key,"PHOTOLIBRARY",i.resources)}}},[t("global-van-button",{attrs:{icon:"photo-fail",type:"primary"}},["本地上传"])])])])])})])]),t("global-tap",{on:{tap:function(){return n.save_tap()}},class:"global-tap"},[t("global-van-button",{class:"global-van-button-save",attrs:{block:!0,type:"info","native-type":"submit",disabled:this.disabled}},["保存"])])])},data:function(){var e={file_ids:[],disabled:!0,select_site_value:!1,select_site_index:"",select_site:"",select_site_id:"",select_site_office:["请选择项目类型"],requirement_description:"",file_list:[],workNo:localStorage.getItem("workNo"),name:localStorage.getItem("name"),deptCode:localStorage.getItem("deptCode"),deptName:localStorage.getItem("deptName"),upload_list:[{text:"巡检文件",key:"review",resources:"05"}]};return Object(r.a)(e,"file_list",{review:[]}),Object(r.a)(e,"files",{review:[]}),e},computed:{},watch:{file_list:{handler:function(e,t){this.change_button_type()},deep:!0,immediate:!0}},methods:{change_button_type:function(){1<=this.file_list.review.length?this.disabled=!1:this.disabled=!0},newperiodic_review__select_site:function(){this.select_site_value=!0},newperiodic_review__cancel:function(){this.select_site_value=!1},newperiodic_review_click_overlay:function(){this.select_site_value=!1},queck_confirm:function(e){this.select_site_value=!1,this.select_site=e,this.select_site_office=e,this.select_site_index=this.select_site.value},queck_confirm_id:function(e){this.select_site_id=e,console.log(this.select_site_id),this.select_site_id=this.select_site_id[this.select_site_index]},save_tap:function(){this.review_save_massage(),this.$router.push("/periodic-review"),n.a.success("保存成功")},requirement_description_input:function(e){this.requirement_description=e},review_save_massage:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.j)({workNo:t.workNo,name:t.name,projectName:t.select_site_office.text,projectId:t.select_site_id.id,inspectDesc:t.requirement_description,fileIds:t.file_ids.join(",")});case 2:case"end":return e.stop()}},e)}))()},uploader_after:function(i,n,r,a){var o=this;return Object(c.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.$toast.loading({message:"上传中...",duration:0,forbidClick:!0}),o.files[n].push(r),e.next=4,Object(s.i)({workNo:o.workNo,name:o.name,relateId:"",statusCode:"04",fileResources:a,base64:r,fileName:"".concat((new Date).getTime(),".png")});case 4:t=e.sent,o.$toast.clear(),t.success?(o.file_list[n].push({url:i,base64:r,file_id:t.data}),o.emit_file_ids()):o.$notify({type:"danger",message:"上传失败"});case 7:case"end":return e.stop()}},e)}))()},uploader_uploader_delete:function(i,n){var r=this;this.file_list[i].map(function(e,t){return e.file_id==n&&r.file_list[i].splice(t,1)}),this.emit_file_ids()},uploader_delete:function(i,n){var r=this;this.file_list[i].map(function(e,t){return e.file_id==n&&r.file_list[i].splice(t,1)}),this.emit_file_ids()},emit_file_ids:function(){var t=this,i=[];Object.keys(this.file_list).map(function(e){return t.file_list[e].map(function(e){return i.push(e.file_id)})}),this.file_ids=i},uploader_photograph_local_tap:function(n,i,r){var a=this;return Object(c.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={PHOTOLIBRARY:{destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,allowEdit:!1,mediaType:Camera.MediaType.PICTURE},CAMERA:{quality:50,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!1,encodingType:Camera.EncodingType.JPEG,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1}},a.m_native_camera_get_picture(t[i],function(){var t=Object(c.a)(regeneratorRuntime.mark(function e(t){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[function(){return a.$notify({type:"danger",message:"您未拍照或者未选择照片"})},function(){var t=Object(c.a)(regeneratorRuntime.mark(function e(t){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.$utils.getImgToBase64(t);case 2:i=e.sent,a.uploader_after(t,n,i,r);case 4:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()],e.t0=t.success,e.t0)return e.next=5,i[t.data.status](t.data.url);e.next=5;break;case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e)}))()},uploading_image_preview:function(e){ImagePreview(this.file_list[e].map(function(e){return e.url}))}}},i=(i("dfe6"),i("2877")),a=Object(i.a)(a,void 0,void 0,!1,null,"3292b4fc",null);t.default=a.exports},b012:function(e,t,i){var n={"./newperiodic-review-form.vue":"86ea"};function r(e){e=a(e);return i(e)}function a(e){if(i.o(n,e))return n[e];e=new Error("Cannot find module '"+e+"'");throw e.code="MODULE_NOT_FOUND",e}r.keys=function(){return Object.keys(n)},r.resolve=a,(e.exports=r).id="b012"},c1c9:function(e,t){e.exports=function(e){return e}},cd9d:function(e,t){e.exports=function(e){return e}},dfe6:function(e,t,i){"use strict";i("4103")},e0ef:function(e,t,i){var n=i("4b17");e.exports=function(e,t){var i;if("function"!=typeof t)throw new TypeError("Expected a function");return e=n(e),function(){return 0<--e&&(i=t.apply(this,arguments)),e<=1&&(t=void 0),i}}},f47e:function(e,t,i){"use strict";i.r(t);var r=i("ade3"),a=i("5530"),n=i("80b0"),o=i.n(n),c=i("1d92"),s=i.n(c),n=(i("d3b7"),i("ddb0"),i("b0c0"),i("e260"),i("027f")),c=i("2f62");t.default={components:Object(n.a)(i("b012").keys()),beforeRouteEnter:function(e,t,i){i(function(e){"user-info"==t.name&&e.other_mutations_animate(Object(a.a)(Object(a.a)({},e.other_state_animate),{},Object(r.a)({},e.$route.name,"right")))})},beforeRouteLeave:function(e,t,i){var n={"police-statistics":null,"police-consumption":null,"report-statistics":null,"police-compare":null,"search-consumption":null,"general-situation":null};this.other_mutations_animate(Object(a.a)(Object(a.a)({},this.other_state_animate),{},Object(r.a)({},e.name,n.hasOwnProperty(e.name)?n[e.name]:"right"))),i()},data:function(){return{m_desc:"局部混入mixin"}},computed:Object(a.a)({},Object(c.b)(["other_state_user_info","other_state_animate","other_state_data_dictionary"])),inject:["provide_set_login_info","provide_clear_login_info","provide_reload_app","provide_set_data_dictionary"],methods:Object(a.a)(Object(a.a)({},Object(c.c)(["other_mutations_hospital_info","other_mutations_animate"])),{},{init_animete:s()(function(){var e=this;this.other_mutations_animate(Object(a.a)(Object(a.a)({},this.other_state_animate),{},{"home-page":"van-fade"})),o()(function(){e.other_mutations_animate(Object(a.a)(Object(a.a)({},e.other_state_animate),{},{"home-page":"right"}))})})}),created:function(){this.init_animete()},mounted:function(){}}}}]);