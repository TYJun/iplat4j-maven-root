<!doctype html>
<html class="no-js">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="stylesheet" href="reference/mui/css/mui.css">
    <link rel="stylesheet" href="reference/css/common.css" />
    <link rel="stylesheet" href="reference/mui/css/mui.picker.min.css">
    <link rel="stylesheet" href="reference/css/clothCommon.css" />
    <link rel="stylesheet" href="reference/bootstrap-3.3.5/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../../../css/android-ios.css">
</head>
<STYLE TYPE="text/css">
    body {
        background: #eee;
    }
    
    .task {
        width: 96%;
        background: #fff;
        margin: 0 auto;
        box-shadow: 1px 1px 10px #b9b9b9;
        margin-bottom: 10px;
        border-top-left-radius: 4px;
        border-top-right-radius: 4px;
        border-bottom-right-radius: 4px;
        border-bottom-left-radius: 4px;
        margin-top: 5px;
    }
    
    .task-title {
        width: 100%;
        height: 40px;
        line-height: 40px;
        padding-left: 15px;
        padding-right: 15px;
        background: #2589ad;
        color: #fff;
        border-top-left-radius: 4px;
        border-top-right-radius: 4px;
    }
    
    .task-info {
        padding-left: 15px;
        padding-right: 15px;
        padding-top: 10px;
        padding-bottom: 10px;
        border-bottom-right-radius: 4px;
        border-bottom-left-radius: 4px;
    }
    
    .first-tr {
        background: #08c1a3;
        height: 40px;
        line-height: 40px;
        color: #ffffff;
        text-align: center;
        /*border-radius: 5px;*/
        box-shadow: 0px 5px #F7F7F7;
    }
    
    .mask {
        height: 70%;
    }
    
    .backColor {
        background: #30c37c;
    }
    
    .dropdown-menu {
        min-width: 150px;
    }
    
    .col-lg-4,
    .col-md-4,
    .col-sm-4,
    .col-xs-4,
    .col-lg-6,
    .col-md-6,
    .col-sm-6,
    .col-xs-6 {
        padding-right: 0px;
        padding-left: 0px;
    }
    
    .dropdown-menu>li>a {
        padding: 6px 20px;
    }
    
    .row {
        margin-right: 0px;
        margin-left: 0px;
    }
    
    .content-table {
        background: #F7F7F7;
        overflow-y: auto;
        margin: 0px 2.2%;
        width: 95.6%;
    }
    
    .first-tr-other {
        height: 40px;
        line-height: 40px;
        color: #333;
        text-align: center;
        border-bottom: 1px solid #a1e4d9;
    }
    
    .first-tr-other:last-child {
        border-bottom: 0;
    }
</STYLE>

<body>
    <header class="mui-bar mui-bar-nav">
        <h1 class="mui-title">增长量前十科室明细表</h1>
        <button class="mui-action-back mui-btn mui-btn-blue mui-btn-link mui-btn-nav mui-pull-left">
        <span class="mui-icon mui-icon-left-nav"></span>
        返回
      </button>
        <!-- <button id="search" class="mui-btn mui-btn-link mui-btn-nav mui-pull-right">
          <span>年月</span>
        </button> -->
    </header>

    <div id="warn" class="warn" hidden>
        <small></small>
    </div>
    <div class="mui-content">
        <div class="dropdown row">
            <div id="selectY1" class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                <button class="btn btn-default dropdown-toggle btn-block" type="button" style="border-radius:2px;" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
            选择年度
            <span class="caret"></span>
            </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                    <li><a href="#">2011</a></li>
                    <li><a href="#">2012</a></li>
                    <li><a href="#">2013</a></li>
                    <li><a href="#">2014</a></li>
                    <li><a href="#">2015</a></li>
                    <li><a href="#">2016</a></li>
                    <li><a href="#">2017</a></li>
                    <li><a href="#">2018</a></li>
                    <li><a href="#">2019</a></li>
                    <li><a href="#">2020</a></li>
                </ul>
            </div>
            <div id="selectM1" class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                <button class="btn btn-default dropdown-toggle btn-block" type="button" style="border-radius:2px;" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
            选择月份
            <span class="caret"></span>
            </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                    <li value="1"><a href="#">1</a></li>
                    <li value="2"><a href="#">2</a></li>
                    <li value="3"><a href="#">3</a></li>
                    <li value="4"><a href="#">4</a></li>
                    <li value="5"><a href="#">5</a></li>
                    <li value="6"><a href="#">6</a></li>
                    <li value="7"><a href="#">7</a></li>
                    <li value="8"><a href="#">8</a></li>
                    <li value="9"><a href="#">9</a></li>
                    <li value="10"><a href="#">10</a></li>
                    <li value="11"><a href="#">11</a></li>
                    <li value="12"><a href="#">12</a></li>
                </ul>
            </div>
        </div>
        <div style="padding: 8px;">
            <div class="mui-row first-tr" style="font-size: 17px;">
                <span id="year">2020</span>年<span id="month">9</span>发放增长前十科室明细
            </div>
        </div>
        <div class="content-table" style="padding: 8px;">
            <div class="mui-row first-tr-other">
                <div class="mui-col mui-col-xs-3">
                    <span style="font-size: 16px;color: black;">科室名称</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span style="font-size: 16px;color: black;">布草名称</span style="font-size: 16px;color: black;">
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span style="font-size: 16px;color: black;">本月增长</span style="font-size: 16px;color: black;">
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span style="font-size: 16px;color: black;">本月发放</span style="font-size: 16px;color: black;">
                </div>
            </div>
            <div id="detail">
                <!-- <div class="mui-row first-tr-other">
                    <div class="mui-col mui-col-xs-3">
                        <span>科室A</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span>大单</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span id="arrow1">10</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span id="num1">100</span id="num1">
                    </div>
                </div>
                <div class="mui-row first-tr-other">
                    <div class="mui-col mui-col-xs-3">
                        <span>科室B</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span>被单</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span>5</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span>1000</span>
                </div>
            </div>
            <div class="mui-row first-tr-other">
                <div class="mui-col mui-col-xs-3">
                    <span>科室C</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span>大单</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span>10</span>
                </div>
                <div class="mui-col mui-col-xs-3">
                    <span>1500</span>
                </div>
            </div> -->
        </div>

    </div>



    </div>


</body>
<script src="reference/mui/js/mui.js" type="text/javascript"></script>
<script src="reference/js/jquery-2.1.4.js" type="text/javascript"></script>
<script src="reference/bootstrap-3.3.5/js/bootstrap.min.js" type="text/javascript"></script>
<script src="reference/js/common.js" type="text/javascript"></script>
<script type="text/javascript" src="reference/mui/js/mui.picker.min.js"></script>
<script type="text/javascript">
    var baseUrl = localStorage.getItem("url");
    var workNo = localStorage.getItem("workNo");
    var dataGroupCode = "BONA";
    var page = 1;
    var html = '';
    var date = new Date();
    var year = date.getFullYear();
    var month = date.getMonth() + 1;
    var time = year + '-' + month;
    $("#year").html(year);
    $("#month").html(month);


    $(function() {
        var width = screen.width - 20;
        $('#container').width(width);
        $('#container').height(300);

        getDeptAbstract(time);
    });


    // 获取布草发放前十的科室及明细表
    function getDeptAbstract(time) {
        $.ajax({
            url: baseUrl + 'app_fineReport.do?getDetailOfDeptNameByGrowth',
            type: 'get',
            data: {
                dataGroupCode: dataGroupCode,
                time: time
            },
            timeout: 30000,
            success: function(data) {
                var data = JSON.parse(data);
                console.log(data);
                var html = '';
                for (var i = 0; i < data.length; i++) {
                    var deptName = data[i].deptName;
                    var clothTypeName = data[i].clothTypeName;
                    var growth = data[i].growth;
                    var sum = data[i].sum;
                    html += createHtml(deptName, clothTypeName, growth, sum);
                }
                $("#detail").html(html);
            },
            complete: function(XMLHttpRequest, status) { //请求完成后最终执行参数
                if (status == 'timeout') {
                    $("#loading").hide();
                    $('#warn small').html('请求超时！');
                    $("#warn").fadeIn(500);
                    setTimeout("$('#warn').fadeOut(500)", 3000);　　　　
                } else if (status == 'error') {
                    $("#loading").hide();
                    $('#warn small').html('网络异常！');
                    $("#warn").fadeIn(500);
                    setTimeout("$('#warn').fadeOut(500)", 3000);　
                }　
            }
        });

    }

    function createHtml(deptName, clothTypeName, growth, sum) {
        var html = '';
        html += '<div class="mui-row first-tr-other">';
        html += '<div class="mui-col mui-col-xs-3" style="line-height:18px;">';
        html += '<span>' + deptName + '</span>';
        html += '</div>';
        html += '<div class="mui-col mui-col-xs-3">';
        html += '<span>' + clothTypeName + '</span>';
        html += '</div>';
        html += '<div class="mui-col mui-col-xs-3">';
        html += '<span>' + growth + '</span>';
        html += '</div>';
        html += '<div class="mui-col mui-col-xs-3">';
        html += '<span>' + sum + '</span>';
        html += '</div>';
        html += '</div>';
        return html;

    }


    // 选择年度
    $('#selectY1 li').click(function() {
        $("#year").html($(this).text());
        year = $(this).text();
        time = year + "-" + month;
        getDeptAbstract(time);
    });

    // 选择月份
    $('#selectM1 li').click(function() {
        $("#month").html($(this).text());
        month = $(this).text();
        time = year + "-" + month;
        getDeptAbstract(time);
    });


    mui.init({
        pullRefresh: {
            container: '#pullrefresh',
            down: {
                callback: pulldownRefresh,
                contentrefresh: "正在刷新",
            },
            up: {
                contentrefresh: "加载中，请稍后",
                contentnomore: '暂无更多数据',
                callback: pullupRefresh
            }
        }
    });

    /**
     * 下滑刷新
     * @return {[type]} [description]
     */
    function pulldownRefresh() {
        setTimeout(function() {
            html = '';
            page = 1;
            loadTask();
            mui('#pullrefresh').pullRefresh().endPulldownToRefresh();
        }, 1500);
    }

    /**
     * 上滑加载更多
     * @return {[type]} [description]
     */
    function pullupRefresh() {
        page++;
        loadTask();
        setTimeout(function() {
            //关闭加载框
            mui('#pullrefresh').pullRefresh().endPullupToRefresh();
        }, 1500);
    }

    //调试代码
    // var html = '';
    // html = createTask("1","2","3","4","5","6","7","8","9","0");
    // $(".mui-content").html(html);
    //调试代码
</script>

</html>