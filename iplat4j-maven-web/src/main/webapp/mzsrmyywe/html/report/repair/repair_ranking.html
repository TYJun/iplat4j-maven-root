<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-siteapp"/>
  <link rel="stylesheet" href="../../../reference/bootstrap-3.3.5/css/bootstrap.min.css"/>
  <link rel="stylesheet" href="../../../css/android-ios.css">
  <link rel="stylesheet" href="../../../css/loading.css"/>
  <link rel="stylesheet" href="../../../css/colorGreen.css"/>
  <link rel="stylesheet" href="../../../css/colorBlue.css"/>
  <link rel="stylesheet" href="../../../reference/mobiscroll-2.5.2/css/mobiscroll.custom-2.5.2.min.css">
</head>
<STYLE TYPE="text/css">
$ {
    demo.css
}
.row {
    margin-right: 0px;
    margin-left: 0px;
}
.navbar {
    margin-bottom: 0px;
}
.badge {
    color: #222;
}
.dropdown-menu {
    min-width: 150px;
}
.col-lg-4, .col-md-4, .col-sm-4, .col-xs-4, .col-lg-6, .col-md-6, .col-sm-6, .col-xs-6 {
    padding-right: 0px;
    padding-left: 0px;
}
.dropdown-menu>li>a {
    padding: 6px 20px;
}
hr {
    margin-top: 0px;
    margin-bottom: 0px;
}
</STYLE>
<body>
    <nav class="navbar navbar-inverse nav-height" style="border-radius:2px;" role="navigation">
        <div style="float:left;">
            <ul class="nav nav-pills ul-btn-right" style="color:#FFFFFF;">
                <li><a href="javascript:back();" style="color:#FFFFFF;">返回</a></li>
            </ul>
        </div>
        <div style="float:right;">
            <ul id="menu" class="nav nav-pills ul-btn-right">
                <li value="Y"><a href="#" style="color:#FFFFFF;">年度</a></li>
                <li value="S"><a href="#" style="color:#FFFFFF;">季度</a></li>
                <li value="M"><a href="#" style="color:#FFFFFF;">月份</a></li>
            </ul>
        </div>
    </nav>
   <div id="warn" class="warn" hidden>
    <small></small>
  </div>

  <div id="loading" class="spinner" style="position:fixed;z-index:9999;text-align:center;width:100%;">
    <div class="bounce1"></div>
    <div class="bounce2"></div>
    <div class="bounce3"></div>
  </div>
   
   <div id ="selectKS" hidden>
   <div class="row" style="margin-top:10px;">
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
          <span style="margin-left: 15px;">科室</span>
        </div>
        <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8" style="text-align:right;">
          <input id="clickLeader" style="border:none;outline:none;text-align:right;padding-right:0px;" oninput="getItemByName(this.value)" placeholder="点击选择科室"></input>
        </div>
      </div>
  <hr style="margin-top:10px;">
  </div>
  
    <div class="row" style="margin-top:10px;">
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
          <span style="margin-left: 15px;">年度</span>
        </div>
        <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8" style="text-align:right;">
          <input id="clickYear" style="border:none;outline:none;text-align:right;padding-right:0px;" oninput="getItemByName1(this.value)" placeholder="点击选择年度"></input>      
        </div>
      </div>
      <hr style="margin-top:10px;">
      
      <div id ="selectSeason" hidden>
      <div class="row" style="margin-top:10px;">
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
          <span style="margin-left: 15px;">季度</span>
        </div>
        <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8" style="text-align:right;">
          <input id="clickSeason" style="border:none;outline:none;text-align:right;padding-right:0px;" oninput="getItemByName2(this.value)" placeholder="点击选择季度"></input>
        </div>
      </div>
      <hr style="margin-top:10px;">
      </div>
      
      <div id ="SelectMonth" hidden>
      <div class="row" style="margin-top:10px;">
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
          <span style="margin-left: 15px;">月份</span>
        </div>
        <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8" style="text-align:right;">
          <input id="clickMonth" style="border:none;outline:none;text-align:right;padding-right:0px;" oninput="getItemByName3(this.value)" placeholder="点击选择月份"></input>
        </div>
      </div>
      <hr style="margin-top:10px;">
     </div>
   
   

    
   <div>
        <ul id="list" class="list-group">
              <li class="list-group-item backColor" style="border-color: #5bc0de;color:#FFFFFF;border-radius: 2px;">
                <span class="badge backColor" style="color:#FFFFFF;">完成量</span>
                成员
            </li>
            <!--<li class="list-group-item" style="background-color:#FFFFFF">
            <span class="badge" style="background-color:#FFFFFF;"> 
                <span style="display: inline-block;width: 37px;";>21</span>
            </span>       
                张三
            </li>-->
                     
        </ul>
  </div>

<div>   
</div>
  
 <!--  领导查看完工量选择科室时的弹出框-->
 <div class="modal fade" id="addIconModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="flase" style="margin-top:15%;">
    <div class="modal-dialog">
      <div class="modal-content" style="width:80%;left:10%;">
        <div class="modal-header">
          <h4 class="modal-title center" id="myModalLabel">
          科室选择
          </h4>
        </div>
        <div class="row">
          <div style="text-align: center;height:300px;width: 100%;overflow-y:auto;">
            <ul id="chooseOne" class="nav nav-pills nav-justified">
            </ul>
          </div>  
        </div> 
      </div>
    </div>
  </div>
  
   <!--  选择年度-->
 <div class="modal fade" id="tableOne" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="flase" style="margin-top:15%;">
    <div class="modal-dialog">
      <div class="modal-content" style="width:80%;left:10%;">
        <div class="modal-header">
          <h4 class="modal-title center" id="myModalLabel">
          选择年度
          </h4>
        </div>
        <div class="row">
          <div style="text-align: center;height:300px;width: 100%;overflow-y:auto;">
            <ul class="nav nav-pills nav-justified" id ="chooseTwo">
            	<li id ="2010年" value="2010"><a>2010年</a></li>
            	<li id ="2011年" value="2011"><a>2011年</a></li>
            	<li id ="2012年" value="2012"><a>2012年</a></li>
            	<li id ="2013年" value="2013"><a>2013年</a></li>
            	<li id ="2014年" value="2014"><a>2014年</a></li>
            	<li id ="2015年" value="2015"><a>2015年</a></li>
            	<li id ="2016年" value="2016"><a>2016年</a></li>
            	<li id ="2017年" value="2017"><a>2017年</a></li>
            	<li id ="2018年" value="2018"><a>2018年</a></li>
            	<li id ="2019年" value="2019"><a>2019年</a></li>
            	<li id ="2020年" value="2020"><a>2020年</a></li>
            	<li id ="2021年" value="2021"><a>2021年</a></li>
            </ul>
          </div>  
        </div> 
      </div>
    </div>
  </div>
  
   <!--  选择季度-->
 <div class="modal fade" id="tableTwo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="flase" style="margin-top:15%;">
    <div class="modal-dialog">
      <div class="modal-content" style="width:80%;left:10%;">
        <div class="modal-header">
          <h4 class="modal-title center" id="myModalLabel">
          选择季度
          </h4>
        </div>
        <div class="row">
          <div style="text-align: center;height:200px;width: 100%;overflow-y:auto;">
            <ul class="nav nav-pills nav-justified" id ="chooseThree">
            	<li id ="第一季度" value="1"><a>第一季度</a></li>
            	<li id ="第二季度" value="2"><a>第二季度</a></li>
            	<li id ="第三季度" value="3"><a>第三季度</a></li>
            	<li id ="第四季度" value="4"><a>第四季度</a></li>
            </ul>
          </div>  
        </div> 
      </div>
    </div>
  </div>
  
   <!--  选择月份-->
 <div class="modal fade" id="tableThree" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="flase" style="margin-top:15%;">
    <div class="modal-dialog">
      <div class="modal-content" style="width:80%;left:10%;">
        <div class="modal-header">
          <h4 class="modal-title center" id="myModalLabel">
          选择月份
          </h4>
        </div>
        <div class="row">
          <div style="text-align: center;height:300px;width: 100%;overflow-y:auto;">
            <ul class="nav nav-pills nav-justified" id ="chooseFour">
            	<li id ="一月" value="1"><a>一月</a></li>
            	<li id ="二月" value="2"><a>二月</a></li>
            	<li id ="三月" value="3"><a>三月</a></li>
            	<li id ="四月" value="4"><a>四月</a></li>
            	<li id ="五月" value="5"><a>五月</a></li>
            	<li id ="六月" value="6"><a>六月</a></li>
            	<li id ="七月" value="7"><a>七月</a></li>
            	<li id ="八月" value="8"><a>八月</a></li>
            	<li id ="九月" value="9"><a>九月</a></li>
            	<li id ="十月" value="10"><a>十月</a></li>
            	<li id="十一月" value="11"><a>十一月</a></li>
            	<li id ="十二月" value="12"><a>十二月</a></li>          	
            </ul>
          </div>  
        </div> 
      </div>
    </div>
  </div>

</body>
<script type="text/javascript" src="../../../js/color.js"></script>
<script src="../../../reference/bootstrap-3.3.5/js/jquery-2.1.4.js" type="text/javascript"></script>
<script src="../../../reference/bootstrap-3.3.5/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../../../reference/mobiscroll-2.5.2/js/mobiscroll.custom-2.5.2.min.js" type="text/javascript"></script>
<script src="../../../reference/mobiscroll-2.5.2/dev/js/mobiscroll.core-2.5.2-zh.js" type="text/javascript"></script>
<script src="../../../reference/mobiscroll-2.5.2/dev/js/mobiscroll.datetime-2.5.1-zh.js" type="text/javascript"></script>
<script src="../js/highcharts.js"></script>
<script src="../js/exporting.js"></script>
<script type="text/javascript">
        var baseUrl = localStorage.getItem("url");
        var workNo = localStorage.getItem("workNo");
        var role = localStorage.getItem("role");
        var deptCode = localStorage.getItem("deptCode");
        var deptName = localStorage.getItem("deptName");
        var date = new Date();
        var year = date.getFullYear();
        var flag = "Y"; //  Y:年   S:季度   M:月份
        var season = "";
        var month = "";
        var teamNum = ""; //领导默认看见的数据    

        $("#clickLeader").val(deptName);
        $("#clickYear").val(year+"年");

        //领导选择科室
        $("#clickLeader").click(function() {
          $('#addIconModal').modal('show');
          $("#loading").show();
          $.ajax({
            type: 'post',
            url: baseUrl + 'app_maintainReportController.do?serviceDept',
            success: function(data) {
              var data = eval("(" + data + ")");
              console.log(data);
              var list = data.obj.data;
              var html = "";
              for (var i = 0; i < list.length; i++) {
                html += "<li value='" + list[i].num + "' id ='" + list[i].name + "'><a href='#'>" + list[i].name + "</a></li>";
              }
              $('#chooseOne').html(html);
              $("#loading").hide();
              $('#chooseOne li').click(function() {
                $("#clickLeader").val($(this).attr('id'));
                teamNum = $(this).attr('value');
                loadData();
                $('#addIconModal').modal('hide');
              })
            },
            complete: function(XMLHttpRequest, status) { //请求完成后最终执行参数　　　　
              if (status == 'timeout') {
                $("#loading").hide();
                $('#warn small').html('加载超时！请检查网络并重试！');
                $("#warn").fadeIn(500);
                setTimeout("$('#warn').fadeOut(500)", 3000);
              } else if (status == 'error') {
                $("#loading").hide();
                $('#warn small').html('网络异常！');
                $("#warn").fadeIn(500);
                setTimeout("$('#warn').fadeOut(500)", 3000);
              }
            }
          });
        });

        //初始化页面
        $(function() {
          if (role.indexOf("LEADER") > -1) {
            $("#selectKS").show();
            teamNum = deptCode;
          } else {
            teamNum = "";
          }
          loadData();
        });

        //选择年份、季度、月份
        $('#menu li').click(function() {
          flag = $(this).attr('value');
          if (flag == "Y") {
            $('#selectSeason').hide();
            $('#SelectMonth').hide();
          } else if (flag == "S") {
            $('#SelectMonth').hide();
            $('#selectSeason').show();
          } else if (flag == "M") {
            $('#selectSeason').hide();
            $('#SelectMonth').show();
          }
        });


        //选择年度
        $("#clickYear").click(function() {
          $("#tableOne").modal('show');
          $('#chooseTwo li').click(function() {
            $("#clickYear").val($(this).attr("id"));
            //alert($(this).attr("id"));
            $("#tableOne").modal('hide');
            year = $(this).attr('value');
            loadData();
          });
        });

        //选择季度
        $("#clickSeason").click(function() {
          $("#tableTwo").modal('show');
          $('#chooseThree li').click(function() {
            $("#clickSeason").val($(this).attr("id"));
            $("#tableTwo").modal('hide');
            season = $(this).attr("value");
            month = "";
            loadData();
          });
        });

        //选择月份
        $("#clickMonth").click(function() {
          $("#tableThree").modal('show');
          $('#chooseFour li').click(function() {
            $("#clickMonth").val($(this).attr("id"));
            $("#tableThree").modal('hide');
            month = $(this).attr("value");
            season = "";
            loadData();
          });
        });


        //更改条件刷新
        function loadData() {
          $("#loading").show();
          $.ajax({
            type: "post",
            url: baseUrl + 'app_maintainReportController.do?getPersonalWorkload',
            timeout: 30000,
            data: {
              flag: flag,
              year: year,
              season: season,
              month: month,
              role: role, //角色
              teamNum: teamNum, //维修班组号
              workNo: workNo
            },
            success: function(data) {
              console.log(teamNum);
              var data = eval("(" + data + ")");
              console.log(data);
              if (data.respCode == 199) {
                $('#warn small').html('查询数据为空！');
                $("#warn").fadeIn(500);
                $("#loading").hide();
                setTimeout("$('#warn').fadeOut(500)", 3000);　
              } else {
                var list1 = new Array();
                list1 = data.obj.data;
                creatList(list1);
                $("#loading").hide();
              }
            },
            complete: function(XMLHttpRequest, status) { //请求完成后最终执行参数      　　　　
              if (status == 'timeout') {
                $("#loading").hide();
                $('#warn small').html('加载超时！请检查网络并重试！');
                $("#warn").fadeIn(500);
                setTimeout("$('#warn').fadeOut(500)", 3000);
              } else if (status == 'error') {
                $("#loading").hide();
                $('#warn small').html('网络异常！');
                $("#warn").fadeIn(500);
                setTimeout("$('#warn').fadeOut(500)", 3000);
              }
            }
          });
        }

        function creatList(list) {
          //console.log(list);
          var html = "";
          html += "<li class='list-group-item backColor' style='border-color: #5bc0de;color:#FFFFFF;border-radius: 2px;'>";
          html += "<span class='badge backColor' style='color:#FFFFFF;'>完成量</span>成员</li>";
          for (var i = 0; i < list.length; i++) {
            html += "<li class='list-group-item' style='background-color:#FFFFFF'><span class='badge' style='background-color:#FFFFFF;'>";
            html += "<span style='display: inline-block;width: 37px;'>" + list[i].y + "</span>";
            html += "</span>" + list[i].name + "</li>";
          }
          $("#list").html(html);
        }

        function back() {
          window.history.back(-1);
        }
              
</script>
</html>
